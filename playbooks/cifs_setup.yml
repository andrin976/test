---
- hosts: localhost
  gather_facts: false
  vars:
    state: present
    vservername: "{{ vserver }}"
  tasks:
  - name: Create cifs_server
    na_ontap_cifs_server:
      state: "{{ state }}"
      vserver: "{{ vservername }}"
      cifs_server_name: "{{ vservername|upper }}"
      service_state: started
      domain: "{{ domain }}"
      ou: "{{ domain_ou }}"
      admin_user_name: "{{ domain_login }}"
      admin_password: "{{ domain_pwd }}"
      hostname: "{{ cluster_mgmt_lif }}"
      username: "{{ netapp_username }}"
      password: "{{ netapp_password }}"
      https: true
      validate_certs: false
      use_rest: Always